#!/bin/sh

set -e

BUN_VERSION="1.1.18"

echo "-----> Installing Bun $BUN_VERSION"

# Download and install bun
curl -fsSL https://bun.sh/install | bash -s -- bun-v$BUN_VERSION

# Ensure the installation path is correct
export BUN_INSTALL="$HOME/.bun"
export PATH=$BUN_INSTALL/bin:$PATH

# Log installation details
echo "Bun installed to: $BUN_INSTALL"
echo "PATH after installation: $PATH"
ls -l $BUN_INSTALL/bin

# Make sure bun is executable
chmod +x $BUN_INSTALL/bin/bun

# Write the environment setup to a profile file in the root directory
echo 'export BUN_INSTALL="$HOME/.bun"' > $BUILD_DIR/.profile
echo 'export PATH="$BUN_INSTALL/bin:$PATH"' >> $BUILD_DIR/.profile

# Ensure the profile file is executable
chmod +x $BUILD_DIR/.profile
