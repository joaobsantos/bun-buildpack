#!/bin/sh

set -e

BUN_VERSION="1.1.18"

echo "-----> Installing Bun $BUN_VERSION"

curl -fsSL https://bun.sh/install | bash -s -- bun-v$BUN_VERSION

# Ensure the installation path is correct
export BUN_INSTALL="$HOME/.bun"
export PATH=$BUN_INSTALL/bin:$PATH

# Log installation details
echo "Bun installed to: $BUN_INSTALL"
echo "PATH after installation: $PATH"
ls -l $BUN_INSTALL/bin

# Make sure bun is executable
chmod +x $BUN_INSTALL/bin/bun

# Create bin directory if it doesn't exist
mkdir -p /app/bin

# Copy bun to /app/bin
cp $BUN_INSTALL/bin/bun /app/bin/bun

# Log bun version
/app/bin/bun --version
